# Excel ИИН Шифровальщик

Минимальное Next.js приложение для шифрования ИИН (Индивидуальный Идентификационный Номер) в Excel файлах с использованием RSA шифрования.

## Как работает алгоритм

### 1. Генерация ключей
- Генерируется пара RSA ключей (публичный/приватный) с длиной модуля 2048 бит
- Используется алгоритм RSA-OAEP с хешированием SHA-256
- Публичный ключ используется для шифрования, приватный - для расшифровки

### 2. Обработка Excel файла
1. **Поиск колонки ИИН:**
   - Ищет ячейку с текстом "ИИН пациента" (игнорирует суффикс "-processed")
   - Запоминает номер колонки и начинает обработку со следующей строки

2. **Шифрование данных:**
   - Проходит по всем ячейкам в найденной колонке
   - Шифрует каждое непустое значение с помощью публичного ключа RSA
   - Заменяет исходные ИИН на зашифрованные строки в base64 формате

3. **Отправка на сервер:**
   - Преобразует весь лист в JSON массив
   - Отправляет зашифрованные данные на API `/api/process`
   - Сервер добавляет суффикс "-processed" ко всем ячейкам (имитация обработки)

4. **Расшифровка результата:**
   - Получает обработанные данные с сервера
   - Пытается расшифровать каждую ячейку приватным ключом
   - Если расшифровка не удается, оставляет данные как есть

### 3. Криптографические функции

#### `generateKeyPair()`
- Создает пару RSA-OAEP ключей 2048 бит
- Возвращает объект с `publicKey` и `privateKey`

#### `encryptCell(text, publicKey)`
- Кодирует текст в UTF-8
- Шифрует с помощью RSA-OAEP
- Преобразует в base64 строку

#### `decryptCell(text, privateKey)`  
- Декодирует base64 в бинарные данные
- Расшифровывает с помощью RSA-OAEP
- Возвращает исходный текст

## Использование

1. Нажмите "Сгенерировать ключи"
2. Загрузите Excel файл с колонкой "ИИН пациента" 
3. ИИН будут зашифрованы, отправлены на сервер, обработаны и расшифрованы обратно

## Безопасность

- ИИН шифруются на клиенте перед отправкой на сервер
- Сервер не имеет доступа к приватному ключу и не может расшифровать данные
- Используется криптографически стойкий алгоритм RSA-OAEP
- Ключи генерируются в браузере и не передаются по сети